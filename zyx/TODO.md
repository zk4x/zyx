- [ ] backends
  - [ ] cuda
    - [x] fix async memcopy
    - [ ] tensor cores
    - [ ] fix load calculation, probably using Atomic usize
    - [ ] fix event memory leaks, all events must be properly destroyed
  - [ ] hip
  - [x] opencl
    - [ ] fix load calculation, probably using Atomic usize
  - [ ] vulkan
  - [x] wgpu
    - [ ] fix load calculation, probably using Atomic usize
  - [x] dummy
- [ ] dtype
  - [ ] quantized dtypes
- [x] runtime
  - [x] graph size optimization - remove axes from Nodes, put it into map like shapes and dtypes
- [x] scheduler
  - [x] cache Map<(Kernel, Optimizations), Program> instead of Map<IRKernel, Program>
  - [ ] fix reshape node
    - [x] merges, splits, reshapes of non reduce axes
    - [ ] inserting new loops to the end of the kernel
  - [ ] pad should also work even with kernels that store stuff, just pad the store view
  - [x] expand reduce bug
  - [x] fix is expandable conditions
  - [ ] tests for fusion, test will create it's own graph and check how the fused kernel looks
    - [ ] softmax fusion test (eventually should be single kernel)
    - [ ] just asserts that various graphs fuse into single kernel
  - [x] scheduling to multiple devices
  - [ ] automatic sharding across devices
  - [ ] fix bug when running phi3, panic on min_kernel function
- [x] kernel
  - [x] ops remove unary view
  - [x] ops remove binary views
- [ ] optimizer
  - [ ] default optimizations
  - [ ] register tiling of all variables
  - [ ] local tiling of all variables
  - [ ] better picking of next optimization, or even optimization search
  - [ ] flash attention
- [x] view
  - [x] split on padded view
  - [x] view padding to ir
    - [x] offset
    - [x] padding condition
  - [x] reshaped view to ir
  - [x] axis merging
  - [x] axes reshape
- [ ] IR
  - [x] add dtype to load vop, so that we don't need to pass graph to ir
  - [x] do not pass graph to ir
  - [x] change ir register id to u16
  - [x] remove ref counting from ir
  - [x] merge all mul + add into mad instructions
  - [x] add new reference counting that accounts for all variables, including indexing variables
  - [ ] loop invariant code motion!
  - [x] fix destructuring back from SSA
  - [x] loop unrolling
  - [ ] loop splitting
  - [x] constant folding and propagation
  - [ ] common subexpression elimination
  - [x] dead store elimination
  - [ ] vectorization, vector dtypes!
  - [ ] ops fusion, merges1

- [x] docs
  - [x] manual for adding new backends
- [x] dependencies
  - [x] replace serde with nanoserde

- examples
  - [ ] get phi working
